<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Poiz Exchange ‚Äî –¢–∞–±–ª–æ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no, maximum-scale=1" />
  <link rel="stylesheet" href="./styles.css?v=blue-03" />
  <script src="./pricing.js?v=60"></script>
  <style>
    .grid-tiles { display:grid; grid-template-columns: repeat(3, 1fr); gap:12px; }
    .rate-card { border-radius:12px; padding:14px; background:var(--card-bg,#fff); box-shadow: var(--card-shadow,0 1px 4px rgba(0,0,0,.06)); }
    .rate-title { font-weight:700; margin-bottom:6px; display:flex; align-items:center; gap:8px; }
    .rate-sub   { font-size:12px; opacity:.7; }
    .big { font-size:22px; font-weight:800; margin-top:6px; }
    .muted { opacity:.6; font-size:12px; }
    @media (max-width:820px){ .grid-tiles{ grid-template-columns: repeat(2,1fr);} }
    @media (max-width:520px){ .grid-tiles{ grid-template-columns: 1fr;} }
  </style>
</head>
<body class="ui-blue">
  <header class="tg-header">
    <div class="wrap">
      <h1 class="title">–¢–ê–ë–õ–û –ö–£–†–°–û–í</h1>
    </div>
  </header>

  <main class="wrap main-safe">
    <section class="card">
      <div class="grid-tiles" id="ratesGrid"></div>
    </section>

    <nav class="footlinks">
      <a href="./index.html">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</a>
      <a href="https://t.me/poizchat" target="_blank">üí¨ –ß–∞—Ç</a>
      <a href="https://t.me/poizmanager" target="_blank">üìû –ê–¥–º–∏–Ω</a>
    </nav>
  </main>

  <script>
    // –∫–∞–∫–∏–µ –≤–∞–ª—é—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ–º (–≤—Å–µ –∫ RUB)
    const CODES = [
      // —Ñ–∏–∞—Ç
      {code:'USD', name:'–î–æ–ª–ª–∞—Ä –°–®–ê'},
      {code:'CNY', name:'–ö–∏—Ç–∞–π—Å–∫–∏–π —é–∞–Ω—å'},
      // crypto —Ç–æ–ø
      {code:'USDT', name:'Tether'},
      {code:'BTC',  name:'Bitcoin'},
      {code:'ETH',  name:'Ethereum'},
      {code:'LTC',  name:'Litecoin'},
      {code:'SOL',  name:'Solana'},
      {code:'XMR',  name:'Monero'},
      {code:'TON',  name:'TON'},
      {code:'XRP',  name:'XRP'},
    ];

    function fmt(n, d=2){ return Number(n).toFixed(d); }

    function cardHTML(item, rateText, extra){
      return `
        <div class="rate-card">
          <div class="rate-title">
            <img src="./icons/${item.code.toLowerCase()}.svg" alt="" width="22" height="22"/>
            <div>${item.name} <span class="muted">(${item.code})</span></div>
          </div>
          <div class="rate-sub">–ö—É—Ä—Å –∫ RUB</div>
          <div class="big">${rateText}</div>
          ${extra? `<div class="muted" style="margin-top:6px;">${extra}</div>` : ``}
        </div>
      `;
    }

    function calcRateToRub(code){
      // —Å—á–∏—Ç–∞–µ–º —Ä—É–±–ª—å -> —Ü–µ–ª–µ–≤–∞—è –≤–∞–ª—é—Ç–∞, –±–µ—Ä—ë–º amount=10000 RUB —á—Ç–æ–±—ã ¬´—É—Å—Ä–µ–¥–Ω–∏—Ç—å¬ª —Å—Ç—É–ø–µ–Ω–∏
      if (!window.PRICING?.quote) return null;
      const q = window.PRICING.quote({ from: 'RUB', to: code, amount: 10000 });
      if (!q?.total || !q?.rateText) return null;
      // rateText —É –Ω–∞—Å ¬´–∑–∞ –ø–æ–ª—É—á–∞–µ–º—É—é –≤–∞–ª—é—Ç—É¬ª ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–ø—Ä–æ—Å—É
      return { rateText: q.rateText, details: `–∑–∞ 1 ${code}` };
    }

    function fillGrid(){
      const grid = document.getElementById('ratesGrid');
      grid.innerHTML = '';
      CODES.forEach(item=>{
        const r = calcRateToRub(item.code);
        const html = cardHTML(item, r?.rateText ?? '‚Äî', r?.details ?? '');
        const el = document.createElement('div');
        el.innerHTML = html.trim();
        grid.appendChild(el.firstChild);
      });
    }

    function boot(){
      if (!window.PRICING?.quote){ setTimeout(boot, 50); return; }
      fillGrid();
    }
    if (document.readyState==='loading') document.addEventListener('DOMContentLoaded', boot); else boot();
  </script>
</body>
</html>
