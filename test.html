<!DOCTYPE html>
<html lang="ru">
<meta charset="utf-8">
<title>Poiz Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<body style="font-family:system-ui;padding:20px">
  <h3>WebApp ping</h3>
  <p>Эта кнопка отправит простое сообщение в бота через tg.sendData.</p>
  <button id="ping">Отправить ping</button>
  <pre id="log" style="white-space:pre-wrap;background:#eee;padding:8px;border-radius:8px"></pre>
<script>
  const log = (t)=>document.getElementById('log').textContent += t+"\n";
  const tg = window.Telegram?.WebApp;
  if (tg){ tg.expand(); tg.ready(); log("TG OK platform="+tg.platform); } else { log("NO TG WEBAPP"); }

  document.getElementById('ping').onclick = ()=>{
    if(!tg){ alert("Открой через кнопку в Telegram"); return; }
    try{
      tg.sendData(JSON.stringify({action:"ping", ts: Date.now()}));
      tg.close();
    }catch(e){ console.error(e); alert("Ошибка tg.sendData"); }
  };
</script>
</body>
</html>
